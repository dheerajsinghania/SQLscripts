SELECT d.name
FROM sys.databases d
LEFT JOIN sys.dm_hadr_database_replica_states drs
    ON d.database_id = drs.database_id
   AND drs.is_local = 1
WHERE
    d.state_desc = 'ONLINE'
    AND (
        drs.is_primary_replica = 1   -- PRIMARY replica
        OR drs.database_id IS NULL   -- Not in an AG
    );
